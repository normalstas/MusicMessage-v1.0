<UserControl x:Class="MusicMessage.UserCtrls.ImageCropperControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="500" d:DesignWidth="600">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Background="#2C2C2C" Name="MainContainer">
            <Grid>
                <Image x:Name="SourceImage" 
                       Stretch="Uniform"
                       HorizontalAlignment="Center" VerticalAlignment="Center"
                       RenderTransformOrigin="0.5,0.5">
                    <Image.RenderTransform>
                        <TransformGroup>
                            <ScaleTransform x:Name="ImageScale"/>
                            <TranslateTransform x:Name="ImageTranslate"/>
                        </TransformGroup>
                    </Image.RenderTransform>
                </Image>

                <Canvas x:Name="OverlayCanvas">
                    <Border x:Name="CropBorder" 
                           
                            BorderBrush="White" 
                            BorderThickness="2"
                            Background="#40000000"
                            Cursor="SizeAll"
                            MouseLeftButtonDown="CropBorder_MouseLeftButtonDown"
                            MouseMove="CropBorder_MouseMove"
                            MouseLeftButtonUp="CropBorder_MouseLeftButtonUp">
                        <Grid>
                            <Rectangle x:Name="ResizeNW" Width="12" Height="12" HorizontalAlignment="Left" VerticalAlignment="Top"
                                       Fill="White" Cursor="SizeNWSE"/>
                            <Rectangle x:Name="ResizeNE" Width="12" Height="12" HorizontalAlignment="Right" VerticalAlignment="Top"
                                       Fill="White" Cursor="SizeNESW"/>
                            <Rectangle x:Name="ResizeSW" Width="12" Height="12" HorizontalAlignment="Left" VerticalAlignment="Bottom"
                                       Fill="White" Cursor="SizeNESW"/>
                            <Rectangle x:Name="ResizeSE" Width="12" Height="12" HorizontalAlignment="Right" VerticalAlignment="Bottom"
                                       Fill="White" Cursor="SizeNWSE"/>
                            <Rectangle x:Name="ResizeW" Width="6" Height="12" HorizontalAlignment="Left" VerticalAlignment="Center"
                                       Fill="White" Cursor="SizeWE"/>
                            <Rectangle x:Name="ResizeE" Width="6" Height="12" HorizontalAlignment="Right" VerticalAlignment="Center"
                                       Fill="White" Cursor="SizeWE"/>
                            <Rectangle x:Name="ResizeN" Width="12" Height="6" HorizontalAlignment="Center" VerticalAlignment="Top"
                                       Fill="White" Cursor="SizeNS"/>
                            <Rectangle x:Name="ResizeS" Width="12" Height="6" HorizontalAlignment="Center" VerticalAlignment="Bottom"
                                       Fill="White" Cursor="SizeNS"/>
                        </Grid>
                    </Border>
                </Canvas>
            </Grid>
        </Border>

        <Border Grid.Row="1" Background="#3C3C3C" Padding="10">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <TextBlock x:Name="TbAspectHint" Text="⬜ Соотношение: Свободное" 
                   VerticalAlignment="Center" Margin="5,0" Foreground="White"/>
                <Button Content="✅ Сохранить" Click="Save_Click" 
               Margin="10,0" Padding="15,5" Background="#007ACC" Foreground="White"/>
                <Button Content="❌ Отмена" Click="Cancel_Click" 
               Margin="5,0" Padding="15,5"/>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>

    